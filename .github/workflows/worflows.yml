name: CI
# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the "master" branch
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest
    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:

      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
        with:
          channel: 'master'
      # Runs a single command using the runners shell
      - name: Run a one-line script
        run: echo Hello, world!
      # Runs a set of commands using the runners shell
      # - name: Run a multi-line script
      - run: flutter pub get
      - run: flutter config --enable-web
      - run: flutter build web --release
      - run: git checkout -b gh-pages
# name: Flutter Web
# on:
#   push:
#     branches:
#       - master
# jobs:
#   build:
#     name: Build Web
#     environment: github-pages
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v3
#       - uses: subosito/flutter-action@v2
#         with:
#           channel: 'master'
#       - run: flutter pub get
#       - run: flutter config --enable-web
#       - run: flutter build web --release
#         working-directory: ./
#       # base-href "/${{ github.event.repository.name }}/"
#       - run: |
#           # 2. change path to [existed lib/main.dart path]/build/web
#           cd ./build/web
#           export GITHUB_TOKEN=${{secrets.ACTION_TOKEN}}
#           ls
#           git init
#           git config --global user.email ninebell94@gmail.com
#           git config --global user.name Ninebell
#           git status
#           git remote add origin https://$@github.com/Ninebell/ninebell.github.io.git 
#           git checkout -b gh-pages
#           git add --all
#           echo commit
#           git commit -m "update"
#           echo push
#           git push --set-upstream origin gh-pages -f
